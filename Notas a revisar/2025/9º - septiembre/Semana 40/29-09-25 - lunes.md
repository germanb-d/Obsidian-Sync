---
journal: Calendario
Diario-Fecha: 2025-09-29
---

# Division En SQL

# Optimización De Consultas

Que sucede entre el DBSM y el disco

![[29-09-25 - lunes-1759182137013.webp]]

## Tiempo De Compilacion

Primero descompone la consulta y la descompone a algo parecido a algebra relacional.

Catalogo del sistema / metadata / etc

Optimiza la consulta: ademas de lo promio como indices, arboles, etc.

- Utiliza estadisticas de la BD, cosas como saber que porcentaje de la tabla son `Alumnos` de `Viedma`
- La cantidad de filas
- El tamaño de los registros
- Cuantos bloques ocupan

Plan de Ejecucion: Como lo resuelve

- Ejecutalo secualcialmente
- Por [[Indice]]
- Etc
Con la consulta y las estadisticas plantean distintos caminos (sin ejecutarlos), calcula el costo de cada uno y lo ejecuta

## Tiempo De Ejecucion

GEnera el codigo en bajo nivel

Recien ahi lee realmente los datos de la tabla

# Partes

## Descomposicion De Consulta

Primero filtro y despues `JOIN`  es mas eficiente #Revisar

- Analisis de lexico
- Normalizacion: Transforma todo a AND y OR sin negaciones
- Analisis semantico ( consultas erroneas)

```SQL
SELECT *
FROM TABLA 
WHERE CAMP1 = 'Y' AND CAMP1 = 'X'
```

Cuando consultamos se realiza con un usuario, los permisos de este pueden ser de lectura, o de lectura y escritura

- ETC

Puedo usar `EXPLAIN` o `EXPLAIN PLAN` dependiendo la BD y esto no ejecutara el codigo, solo me mostrara de que forma lo resolveria

NDistinct (a, R): Cantidad de valores distintos : la cantidad de valores distintos

Producto o combinación

 Bucle anidado por bloques : en los bucles anidados siempre me conviene el mas grande afuera.

 Bucle anidado indexado

- La indexada va siempre adentro
- Si ambas estan indexadas primero cruza las claves?
 Ordenamiento-fusión
 Combinación hash

Si la tabla es muy chica no pongan [[Indice]]. El [[Indice]] es mejor no poner todas las columnas porque ademas del tiempo de busqueda, el [[Indice]] hay que mantenerlos.

De las tablas candidatas hay que crear un [[Indice]].

## Parseo De Sentencias

Tabla apartada de las sentencias mas utilizadas

Que sucede cuando cambian las estadísticas? : Al verificar las estadísticas, invalida toda la tabla de sentencias y la debe volver a sentenciar. (el DMBS determina cuando un cambio es lo suficientemente grande como para invalidar y volver a sentenciar)

Que sucede cuando cambio el catalogo del sistema? En este caso aunque solo cambie un poco la sentencia, la tomara como una nueva y creara una nueva sentencia. No limpia la tabla de sentencias hasta que se llene y elimine las sentencias que hace mas tiempo no se utilizaron.

Si no se actualizan las estadisticas aunque el resultado sera correcto estos seran muchoas mas lentos.
